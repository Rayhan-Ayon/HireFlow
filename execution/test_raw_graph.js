const fetch = require('isomorphic-fetch');

const accessToken = "eyJ0eXAiOiJKV1QiLCJub25jZSI6IlBLMkwwRmpNR0tVWE1zMmFoNEhDWGYzdUJKU2hLRlU4VWhtZ25yVU5hX28iLCJhbGciOiJSUzI1NiIsIng1dCI6IlBjWDk4R1g0MjBUMVg2c0JEa3poUW1xZ3dNVSIsImtpZCI6IlBjWDk4R1g0MjBUMVg2c0JEa3poUW1xZ3dNVSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8yMDBhODE2ZC02MGE3LTRjMmQtYThiNC0zYzU2ZGVkYjAwZGMvIiwiaWF0IjoxNzY5MjQxMDIyLCJuYmYiOjE3NjkyNDEwMjIsImV4cCI6MTc2OTI0NTcyOCwiYWNjdCI6MCwiYW ACRIjoiMSIsImFjcnMiOlsicDEiXSwiYWlvIjoiQWNRQU8vOGJBQUFBb1p1VjdJOWlyVGE2c1BUVFVoY0FMQlUxbGlRYkw5bFhwWmlIQWVPeDZ3SEFhY0NaSFFlUTJCMG9nQStKejJIT0s4RllFQjdpYkFuRWNrNzVVWW9kaWQzamk3Qi9BcXVBNXk1V1ZoeEpOM3RhVlZZNHBvVWk4bGd0UUsybGpGbzU4N0NseHFzNmE3a1ZrQytRMlhnenRyeG14cXEyTjMzb1l2M0JvUHp1WndGTi9Vc2JtUmJiS2JmODEyZWYwZWo0VFpzscll5MUZhdkd3S2ZJcFNQOVZ2QlZiQjFxc1dURzlPR1NZb0VHZi82UnBqWk96aEhvWGpyRk5RTzhPWjBVQyIsImFsdHNlY2lkIjoiMTpsaXZlLmNvbTowMDAzMDAwMDJFQzRFMUZDIiwiYW1yIjpbInB3ZCIsIm1mYSJdLCIsImFwcF9kaXNwbGF5bmFtZSI6IkhpcmVGbG93IiwiYXBwaWQiOiI4NzczOGU4OS0yN2E4LTRkOGYtODkxYy1mZTMxNjM1MDkxNTAiLCJhcHBpZGFjciI6IjEiLCJlbWFpbCI6InJheWhhbmF5b243NUBnbWFpbC5jb20iLCJmYW1pbHlfbmFtZSI6IlNhcndhciIsImdpdmVuX25hbWUiOiJSYXloYW4iLCJpZHAiOiJsaXZlLmNvbSIsImlkdHlwIjoidXNlciIsImlwYWRkciI6IjIyMy4yNS4yNTMuMTcyIiwibmFtZSI6IlJheWhhbiBTYXJ3YXIiLCJvaWQiOiIwYmExMDAyZC1mYzI5LTQyMjMtODRkMy1iODliNDJmOWZkMGYiLCJwbGF0ZiI6IjMiLCJwdWlkIjoiMTAwMzIwMDU3Rjk5Q0ExQiIsInJoIjoiMS5BY1lBYllFS0lLZGdMVXlvdER4VzN0c0EzQU1BQUFBQUFBQXdBQUFBQUFBQUFDSUFlVEdBQS4iLCJzY3AiOiJDYWxlbmRhcnMuUmVhZFdyaXRlIE1haWwuUmVhZCBNYWlsLlNlbmQgb3BlbmlkIHByb2ZpbGUgVXNlci5SZWFkIGVtYWlsIiwic2lkIjoiMDAxMmZzYWEtZjE1MC0wNjE1LTQwOTItMmVlNDNmMjQ2YWNjIiwic2lnbmluX3N0YXRlIjpbImttc2kiXSwic3ViIjoiV3YyVXF1ZnVIREExY2VwNWZNLUwxRndWUFZydkRUdDJJQng5YW44bzdXcFUiLCJ0ZW5hbnRfcmVnaW9uX3Njb3BlIjoiQVMiLCJ0aWQiOiIyMDBhODE2ZC02MGE3LTRjMmQtYThiNC0zYzU2ZGVkYjAwZGMiLCJ1bmlxdWVfbmFtZSI6ImxpdmUuY29tI3JheWhhbmF5b243NUBnbWFpbC5jb20iLCJ1dGkiOiJndFQyZzA2S2lVR0pUSnhub1BJQkFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLCJiNzlmbmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX2FjZCI6MTc2OTI0MDA3NywieG1zX2FjdF9mY3QiOiIzIDkiLCJ4bXNfZnRkIjoidkR4c2J3RU5ycTZTZVp0N3BSSHdsWENlX0RQM0JQVmZS bllRS0VkZUtmSUJZWE5wWVhOdmRYUm9aV0Z6ZEMxa2MyMXoiLCJ4bXNfaWRyZWwiOiIxIDI0IiwieG1zX3N0Ijp7InN1YiI6Im91cHFkWFF0TGRMaUtrUVBKNldXbXZBUUtLTS1zVjE0R0lVYkx0U09vQWcifSwieG1zX3N1Yl9mY3QiOiIzIDIiLCJ4bXNfdGNkdCI6MTc2OTIzNzI5OCwieG1zX3RudF9mY3QiOiIzIDE0In0.dm1ixc1LsikmjVG_iZfNmjkM_G5j4fvrRALQ7a2qKwoyFxbEf5UuxlEZKlL7uzzCDsy4ejIoCYfuzseo-3ATlZLNnNaAMcQ_h6MBO0gl0EzuTRNqd_8924-lHPmjPvl9mlnPN9FYZhErns9Ii_GBDuX2ZUebgLd1sNvlwvTdP_8_drhxlnLWlInDYY75CVy1cjilHYI00dm8TyYgE9kyV47MoyP_NvHnoNNpGf8yE7aIzlej5d0MvsqCYW2gPMIaY74ipXasOZKLNQylhpyLSdak8oA_elYm9reanq-Eh-P1DeQELb3zQ31UefkBKH-px_CUUY0rYQdFKgQ_9BAWyQ";

async function testRaw() {
    console.log('Fetching /me from Graph...');
    const res = await fetch('https://graph.microsoft.com/v1.0/me', {
        headers: {
            'Authorization': `Bearer ${accessToken}`
        }
    });

    console.log('Status:', res.status);
    const data = await res.json();
    console.log('Body:', JSON.stringify(data, null, 2));
}

testRaw();
